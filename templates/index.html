<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skin Disease Detection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .upload-section {
            margin-bottom: 20px;
            text-align: center;
            padding: 20px;
            border: 2px dashed #ddd;
            border-radius: 5px;
            background-color: #f8f9fa;
        }
        #file-input {
            display: none;
        }
        .upload-btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .upload-btn:hover {
            background-color: #2980b9;
        }
        .submit-btn {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 12px 0;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
            text-align: center;
        }
        .submit-btn:hover {
            background-color: #27ae60;
        }
        .submit-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .result-section {
            text-align: center;
            margin-top: 30px;
            display: none;
        }
        .result-card {
            padding: 20px;
            border-radius: 8px;
            background-color: #f1f9f1;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        #preview-image {
            max-width: 100%;
            max-height: 300px;
            margin: 20px 0;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 20px auto;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error-message {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 10px;
            display: none;
        }
        .disease-info {
            text-align: left;
            margin-top: 10px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
        }
        .prediction-bar {
            height: 20px;
            background-color: #3498db;
            border-radius: 4px;
            margin-bottom: 5px;
        }
        .top-predictions {
            margin-top: 20px;
            text-align: left;
        }
        .prediction-item {
            margin-bottom: 15px;
        }
        .disclaimer {
            font-size: 0.8em;
            color: #777;
            margin-top: 20px;
            text-align: center;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 0.9em;
            color: #777;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Skin Disease Detection</h1>
        
        <div class="upload-section">
            <p>Upload an image of the skin condition for analysis</p>
            <input type="file" id="file-input" accept="image/*">
            <label for="file-input" class="upload-btn">Choose Image</label>
            <p id="file-name">No file chosen</p>
            <img id="preview-image" style="display: none;">
        </div>
        
        <button id="submit-btn" class="submit-btn" disabled>Analyze Image</button>
        
        <div class="loader" id="loader"></div>
        <div class="error-message" id="error-message"></div>
        
        <div class="result-section" id="result-section">
            <h2>Analysis Results</h2>
            <div class="result-card">
                <p><strong>Primary Detected Condition:</strong> <span id="disease-name">-</span></p>
                <p><strong>Confidence:</strong> <span id="confidence">-</span></p>
                
                <div class="top-predictions" id="top-predictions">
                    <h3>Top Predictions</h3>
                    <div id="predictions-list"></div>
                </div>
                
                <div class="disease-info" id="disease-info">
                </div>
                
                <div class="disclaimer">
                    <p><strong>Disclaimer:</strong> This is an AI-assisted diagnosis tool and should not replace professional medical advice. 
                    Please consult with a dermatologist for proper diagnosis and treatment.</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>Skin Disease Detection System | Powered by MobileNetV2 | Â© 2025</p>
    </div>

    <script>
        const fileInput = document.getElementById('file-input');
        const fileName = document.getElementById('file-name');
        const previewImage = document.getElementById('preview-image');
        const submitBtn = document.getElementById('submit-btn');
        const loader = document.getElementById('loader');
        const errorMessage = document.getElementById('error-message');
        const resultSection = document.getElementById('result-section');
        const diseaseName = document.getElementById('disease-name');
        const confidence = document.getElementById('confidence');
        const diseaseInfo = document.getElementById('disease-info');
        const predictionsList = document.getElementById('predictions-list');
        
        // Disease information
        const diseaseInformation = {
            "actinic keratosis": "Actinic keratosis is a precancerous skin growth caused by sun exposure. It appears as rough, scaly patches on sun-exposed areas like face, lips, ears, scalp, neck, forearms and hands.",
            "basal cell carcinoma": "Basal cell carcinoma is the most common form of skin cancer. It often appears as a slightly transparent bump on the skin, though it can take other forms. It occurs most often on areas exposed to the sun.",
            "pigmented benign keratosis": "Benign keratosis is a non-cancerous growth that develops from skin cells. They are usually brown, black or tan and appear on the face, chest, shoulders or back.",
            "dermatofibroma": "Dermatofibroma is a common benign skin tumor. It's a small, firm bump that usually appears on the legs but can appear anywhere on the body. They are usually painless and may be pink, gray, red or brown in color.",
            "melanoma": "Melanoma is the most serious type of skin cancer. It develops in the cells that produce melanin, the pigment that gives skin its color. Melanomas can develop anywhere on the body and often resemble moles.",
            "melanocytic nevi": "Melanocytic nevi, commonly known as moles, are benign growths of melanocytes. They can appear anywhere on the skin and can be flat or raised, smooth or rough, and may have hair growing from them.",
            "vascular lesion": "Vascular lesions are relatively common abnormalities of the skin and underlying tissues, more commonly known as birthmarks. They are caused by abnormal blood vessels located in or under the skin."
        };
        
        fileInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const file = this.files[0];
                fileName.textContent = file.name;
                
                // Preview the image
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                    submitBtn.disabled = false;
                };
                reader.readAsDataURL(file);
            } else {
                fileName.textContent = 'No file chosen';
                previewImage.style.display = 'none';
                submitBtn.disabled = true;
            }
        });
        
        submitBtn.addEventListener('click', function() {
            if (!fileInput.files || !fileInput.files[0]) {
                return;
            }
            
            // Show loader, hide results and error
            loader.style.display = 'block';
            resultSection.style.display = 'none';
            errorMessage.style.display = 'none';
            submitBtn.disabled = true;
            
            const formData = new FormData();
            formData.append('file', fileInput.files[0]);
            
            fetch('/api/predict', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Hide loader
                loader.style.display = 'none';
                
                if (data.error) {
                    errorMessage.textContent = data.error;
                    errorMessage.style.display = 'block';
                    submitBtn.disabled = false;
                    return;
                }
                
                // Display primary prediction
                diseaseName.textContent = data.predicted_class;
                confidence.textContent = data.confidence;
                
                // Display top predictions
                predictionsList.innerHTML = '';
                if (data.top_predictions) {
                    data.top_predictions.forEach(prediction => {
                        const predItem = document.createElement('div');
                        predItem.className = 'prediction-item';
                        
                        const label = document.createElement('div');
                        label.innerHTML = `<strong>${prediction.class}</strong> (${prediction.confidence.toFixed(2)}%)`;
                        
                        const bar = document.createElement('div');
                        bar.className = 'prediction-bar';
                        bar.style.width = `${prediction.confidence}%`;
                        
                        predItem.appendChild(label);
                        predItem.appendChild(bar);
                        predictionsList.appendChild(predItem);
                    });
                }
                
                // Add disease information
                const info = diseaseInformation[data.predicted_class] || 'No additional information available.';
                diseaseInfo.innerHTML = `<p><strong>About this condition:</strong></p><p>${info}</p>`;
                
                // Show results section
                resultSection.style.display = 'block';
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('Error:', error);
                loader.style.display = 'none';
                errorMessage.textContent = 'Error analyzing image. Please try again.';
                errorMessage.style.display = 'block';
                submitBtn.disabled = false;
            });
        });
    </script>
</body>
</html> 